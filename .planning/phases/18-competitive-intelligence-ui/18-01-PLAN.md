---
phase: 18-competitive-intelligence-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - scrapegrape/frontend/src/components/report/ReadinessBadge.tsx
  - scrapegrape/frontend/src/components/report/ConfidenceBadge.tsx
  - scrapegrape/frontend/src/Pages/Jobs/Show.tsx
autonomous: true

must_haves:
  truths:
    - "Report card has a Competitive Intelligence section showing CC presence, Google News readiness, and update frequency"
    - "CC presence shows page count and crawl date when available, 'Not checked' when null, 'Unavailable' on error, 'Not found' when absent"
    - "Google News readiness shows signal breakdown (news sitemap, NewsArticle schema, NewsMediaOrganization) with check/cross icons and a readiness level badge"
    - "Update frequency shows estimated rate with confidence indicator and source attribution"
    - "All three sub-sections handle null/missing/error data gracefully with no blank cards or crashes"
    - "CC presence is NOT duplicated in the Discovery section (removed from there)"
  artifacts:
    - path: "scrapegrape/frontend/src/components/report/ReadinessBadge.tsx"
      provides: "Readiness level badge (strong/moderate/minimal/none)"
      exports: ["ReadinessBadge"]
    - path: "scrapegrape/frontend/src/components/report/ConfidenceBadge.tsx"
      provides: "Confidence level badge (high/medium/low)"
      exports: ["ConfidenceBadge"]
    - path: "scrapegrape/frontend/src/Pages/Jobs/Show.tsx"
      provides: "Competitive Intelligence Card section in ReportCard"
      contains: "Competitive Intelligence"
  key_links:
    - from: "scrapegrape/frontend/src/Pages/Jobs/Show.tsx"
      to: "ReadinessBadge"
      via: "import and render in Google News Readiness sub-section"
      pattern: "import.*ReadinessBadge"
    - from: "scrapegrape/frontend/src/Pages/Jobs/Show.tsx"
      to: "ConfidenceBadge"
      via: "import and render in Update Frequency sub-section"
      pattern: "import.*ConfidenceBadge"
    - from: "Show.tsx ReportCard"
      to: "job.cc_result, job.news_signals_result, job.frequency_result"
      via: "Inertia props already flowing from backend"
      pattern: "job\\.cc_result|job\\.news_signals_result|job\\.frequency_result"
---

<objective>
Add a Competitive Intelligence section to the report card in Jobs/Show.tsx displaying three signals: Common Crawl presence, Google News readiness, and update frequency. Create ReadinessBadge and ConfidenceBadge components. Remove CC display from Discovery section to avoid duplication.

Purpose: This is the final phase of v2.1 -- users see all competitive intelligence data in a dedicated, well-organized report card section.
Output: Competitive Intelligence Card visible on completed job pages with all three sub-sections and graceful null handling.
</objective>

<execution_context>
@/Users/matt/.claude/get-shit-done/workflows/execute-plan.md
@/Users/matt/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-competitive-intelligence-ui/18-RESEARCH.md
@scrapegrape/frontend/src/Pages/Jobs/Show.tsx
@scrapegrape/frontend/src/components/report/PaywallBadge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ReadinessBadge and ConfidenceBadge components</name>
  <files>
    scrapegrape/frontend/src/components/report/ReadinessBadge.tsx
    scrapegrape/frontend/src/components/report/ConfidenceBadge.tsx
  </files>
  <action>
Create two small badge components following the exact pattern of PaywallBadge.tsx:

**ReadinessBadge.tsx** -- Google News readiness level display:
- Props: `{ level: string }`
- 4 variants: strong (emerald), moderate (blue), minimal (amber), none (gray)
- Labels: "Strong", "Moderate", "Minimal", "None"
- Same className pattern as PaywallBadge: `inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium`
- Fallback to `none` style for unknown values

**ConfidenceBadge.tsx** -- Update frequency confidence indicator:
- Props: `{ level: string }`
- 3 variants: high (emerald), medium (amber), low (gray)
- Display text: "{level} confidence" (e.g., "high confidence")
- Same className pattern as PaywallBadge
- Fallback to `low` style for unknown values

Both components are pure presentational, no hooks, no side effects. Export as named exports.
  </action>
  <verify>
Run `npx tsc --noEmit` from scrapegrape/frontend/ to confirm both files compile without type errors.
  </verify>
  <done>
ReadinessBadge renders 4 color variants for readiness levels. ConfidenceBadge renders 3 color variants with "{level} confidence" text.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Competitive Intelligence Card to ReportCard and remove CC from Discovery</name>
  <files>
    scrapegrape/frontend/src/Pages/Jobs/Show.tsx
  </files>
  <action>
Modify the ReportCard component in Show.tsx with these changes:

**1. Add imports** at the top of the file:
- `import { ReadinessBadge } from '@/components/report/ReadinessBadge'`
- `import { ConfidenceBadge } from '@/components/report/ConfidenceBadge'`
- Add `Newspaper`, `Clock` to the lucide-react import (Globe already imported)

**2. Remove CC display from Discovery section:**
- Delete the Common Crawl `<div>` block currently in the Discovery CollapsibleContent (lines ~680-693 -- the `<div className="flex items-center gap-2 pt-1">` containing Globe icon and "Common Crawl" text). This avoids duplication since CC moves to Competitive Intelligence.

**3. Add Competitive Intelligence Card** between the Discovery Collapsible and the Article Analysis Card (before the `{/* Article Analysis */}` comment). The Card is NOT collapsible (always visible, like Article Analysis). Structure:

```
<Card>
  <CardHeader>
    <CardTitle>Competitive Intelligence</CardTitle>
  </CardHeader>
  <CardContent className="space-y-5">
    {/* CC Presence sub-section */}
    {/* Google News Readiness sub-section */}
    {/* Update Frequency sub-section */}
  </CardContent>
</Card>
```

**CC Presence sub-section:**
- Icon: Globe (already imported)
- Title: "Common Crawl Presence"
- Three-tier null handling:
  - `!job.cc_result` -> SectionPlaceholder with label="Common Crawl" reason="Not checked"
  - `job.cc_result.available === false` -> "Unavailable" with error message if present
  - `job.cc_result.in_index === true` -> "~{page_count.toLocaleString()} pages | Last crawled {latest_crawl}"
  - `job.cc_result.in_index === false` -> "Not found in Common Crawl index"
- Use `pl-6` for content indentation (matching existing sub-section pattern)

**Google News Readiness sub-section:**
- Icon: Newspaper (new import)
- Title: "Google News Readiness" with ReadinessBadge inline when readiness is available
- Three-tier null handling:
  - `!job.news_signals_result` -> SectionPlaceholder with label="Google News" reason="Not checked"
  - `job.news_signals_result.error` -> "Unavailable: {error}"
  - Otherwise -> signal breakdown list
- Signal breakdown: 3 rows in a `<div className="space-y-1 pl-6">`, each using CircleCheck/CircleX pattern (already used in AI Bot Blocking):
  - "News Sitemap" -> `signals.has_news_sitemap`
  - "NewsArticle Schema" -> `signals.has_news_article_schema` (show `article_schema_type` in parentheses when present and truthy)
  - "NewsMediaOrganization" -> `signals.has_news_media_org` (show `org_schema_type` in parentheses when present and truthy)
- Check icon: `<CircleCheck className="size-3.5 text-emerald-600 shrink-0" />`
- Cross icon: `<CircleX className="size-3.5 text-gray-300 shrink-0" />`
- Label text: present signals use `text-foreground`, absent use `text-muted-foreground`

**Update Frequency sub-section:**
- Icon: Clock (new import)
- Title: "Update Frequency"
- Three-tier null handling:
  - `!job.frequency_result` -> SectionPlaceholder with label="Update frequency" reason="Not checked"
  - `!job.frequency_result.frequency_label` (empty string or null) -> "Could not estimate publishing frequency"
  - Otherwise -> show frequency_label text, ConfidenceBadge for confidence, and source attribution like "from RSS" or "from sitemap" in muted text
- Display pattern (when data available):
  ```
  <p className="text-sm text-muted-foreground pl-6">
    {frequency_label} <ConfidenceBadge level={confidence} />
    <span className="text-xs"> from {source}</span>
  </p>
  ```
  - Only show source attribution when source is "rss" or "sitemap" (not when "none")

Cast result fields appropriately since they come from JSON: `(job.cc_result.page_count as number)`, `(job.news_signals_result.signals as Record<string, unknown>)`, etc.
  </action>
  <verify>
Run `npx tsc --noEmit` from scrapegrape/frontend/ to confirm no type errors. Run `npm run build` from scrapegrape/frontend/ to confirm production build succeeds. Visually verify: the Competitive Intelligence section should appear between Discovery and Article Analysis on a completed job page, CC should NOT appear in the Discovery section.
  </verify>
  <done>
Competitive Intelligence Card appears between Discovery and Article Analysis in the report card. CC presence shows page count/crawl date or graceful fallback. Google News readiness shows signal breakdown with ReadinessBadge. Update frequency shows rate with ConfidenceBadge. CC is no longer in the Discovery section. All null/error states handled without blank cards or crashes.
  </done>
</task>

</tasks>

<verification>
1. `cd scrapegrape/frontend && npx tsc --noEmit` -- no TypeScript errors
2. `cd scrapegrape/frontend && npm run build` -- production build succeeds
3. Visual check: Competitive Intelligence Card is visible on completed job report card
4. Visual check: CC presence NOT duplicated in Discovery section
5. Visual check: null result fields show graceful placeholder messages, not blank space
</verification>

<success_criteria>
- Report card displays Competitive Intelligence section with three sub-sections (CC, Google News, Frequency)
- ReadinessBadge shows 4-tier colored badges for Google News readiness
- ConfidenceBadge shows 3-tier colored badges for frequency confidence
- All null/error/missing data states produce clear user-facing messages
- No duplicate CC display between Discovery and Competitive Intelligence
- TypeScript compiles and production build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/18-competitive-intelligence-ui/18-01-SUMMARY.md`
</output>
